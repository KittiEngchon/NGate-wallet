<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>NGate Wallet Dashboard</title>
  <link rel="stylesheet" href="style.css" />
  <script src="libs/web3.min.js"></script>
  <script src="wallet.js"></script>
  <script src="balance.js"></script>
  <script src="kyc.js"></script>
  <script src="ui.js"></script>
</head>
<body>
  <header>
    <h1>ğŸ“Š NGate Dashboard</h1>
    <button onclick="connectWallet()">ğŸ”— Connect Wallet</button>
    <button onclick="toggleTheme()">ğŸŒ“ Toggle Theme</button>
  </header>

  <section id="user-info"></section>

  <section id="balances">
    <h2>ğŸ’° à¸ªà¸´à¸™à¸—à¸£à¸±à¸à¸¢à¹Œà¸‚à¸­à¸‡à¸„à¸¸à¸“</h2>
    <ul id="asset-list"></ul>
  </section>

  <script>
    async function loadDashboard() {
      const address = localStorage.getItem("wallet");
      if (!address) {
        toast("â— à¸à¸£à¸¸à¸“à¸²à¹€à¸Šà¸·à¹ˆà¸­à¸¡ Wallet à¸à¹ˆà¸­à¸™");
        return;
      }

      const user = await getUserInfo(address);
      if (user) {
        document.getElementById("user-info").innerHTML = `
          <p><strong>ğŸ‘¤ DID:</strong> ${user.did}</p>
          <p><strong>ğŸ“§ Email:</strong> ${user.email}</p>
          <p><strong>ğŸ“› à¸Šà¸·à¹ˆà¸­:</strong> ${user.name}</p>
        `;
      }

      const res = await fetch("assets.json");
      const assets = await res.json();

      const list = document.getElementById("asset-list");
      for (let asset of assets) {
        const balance = await getBalance(address, asset);
        const item = document.createElement("li");
        item.innerHTML = `
          <img src="${asset.logo}" width="24" height="24" />
          <strong>${asset.symbol}</strong>: ${balance.toFixed(4)}
        `;
        list.appendChild(item);
      }
    }

    window.addEventListener("load", loadDashboard);
  </script>
</body>
</html>
